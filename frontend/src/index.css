@layer reset, base, layouts, components, utilities;

@layer reset {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
    /* outline: green 1px solid; */
  }

  * {
    margin: 0;
    padding: 0;
    font: inherit;
    /* Get rid of all font sizes and heights */
  }

  html {
    /* Default font size is 100% */
    color-scheme: dark light;
    /* Default dark */
    hanging-punctuation: first last;
    /* Not supported in Chrome */
  }

  body {
    min-height: 100vh;
  }

  /* Media responsive */
  img,
  picture,
  svg,
  video {
    display: block;
    max-width: 100%;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    text-wrap: balance;
  }

  p {
    max-width: 75ch;
    text-wrap: pretty;
    /* Prevents orphans on lines */
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  span,
  a {
    color: var(--clr-primary);
  }

  @media (prefers-reduced-motion: no-preference) {
    :has(:target) {
      scroll-behavior: smooth;
      scroll-padding-top: 3rem;
    }
  }
}

@layer base {
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap');

  :root {
    font-family: 'Libre Baskerville', Georgia, 'Times New Roman', serif;
    font-synthesis: none;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;

    /* TODO: Extract magic numbers into CSS variables — see README.md "CSS Variables Cleanup" */

    --clr-primary: #fff;
    --clr-secondary: #0a0908;
    --clr-tertiary: #1a1816;

    /* Vintage bakelite and brass palette */
    --clr-meter-display-boundary: #e8e0d0;
    --level-clr-primary: #c41e3a; /* Cardinal red */
    --level-clr-secondary: #cd7f32; /* Bronze */
    --needle-holder-clr: #8b7355; /* Weathered brass */
    --needle-clr: #1a1a1a;

    /* Vintage meter colors */
    --meter-face-cream: #f7f3e3;
    --meter-face-aged: #efe8d5;
    --meter-bezel-dark: #2a2520;
    --meter-bezel-light: #4a453d;
    --meter-brass: #b8860b;
    --meter-brass-dark: #8b6914;
    --meter-patina: #5c6b5d;

    --min-col-width: 18.75rem;
    --border-radius-primary: 0.28rem;

    --meter-level-thickness: 0.47em;
    --meter-tick-width: 0.094em;
    --meter-display-margin: 6%;
    --meter-padding: 1.5rem;
    --meter-aspect-ratio: calc(3 / 4);

    color-scheme: light dark;
  }

  @media (prefers-color-scheme: light) {
    :root {
      --clr-primary: #1a1816;
      --clr-secondary: #f5f0e6;
    }
  }
}

@layer layouts {
  main {
    min-height: 100svh;
    display: grid;
    place-items: center;
    grid-template-columns: 2fr 3fr; /* Detector is larger and more prominent */
    gap: 1.5rem;
    background-color: var(--clr-secondary);
  }
}

@layer components {
  /* Audio Recorder */
  .audio-recorder {
    display: grid;
    gap: 0.75rem;
    align-items: start;
    width: 100%;
    max-width: 100%;
    max-height: 100%;
    box-sizing: border-box;
    overflow: visible; /* Allow buttons to show */
  }

  .audio-recorder__mic-wrapper {
    display: grid;
    justify-items: center;
    gap: 0.75rem;
  }

  .audio-recorder__mic {
    --size: clamp(3rem, 8.25vw, 5.625rem);
    position: relative;
    width: var(--size);
    height: var(--size);
    border-radius: 50%;
    border: none;
    background: radial-gradient(circle at 35% 35%, #2e2e2e, #1a1a1a);
    box-shadow:
      0 6px 18px rgba(0, 0, 0, 0.45),
      inset 0 0 0 1px rgba(255, 255, 255, 0.08);
    color: #fff; /* Always white icon on dark button for proper contrast */
    cursor: pointer;
    display: grid;
    place-items: center;
    transition:
      transform 120ms ease,
      box-shadow 160ms ease;
  }

  .audio-recorder__mic:hover {
    box-shadow:
      0 8px 22px rgba(0, 0, 0, 0.55),
      inset 0 0 0 1px rgba(255, 255, 255, 0.12);
  }
  .audio-recorder__mic:active {
    transform: scale(0.98);
  }
  .audio-recorder__mic:focus-visible {
    outline: 3px solid #3b82f6;
    outline-offset: 4px;
  }

  @keyframes mic-pulse {
    0%,
    100% {
      box-shadow:
        0 6px 18px rgba(0, 0, 0, 0.45),
        inset 0 0 0 1px rgba(255, 255, 255, 0.08),
        0 0 0 0 rgba(59, 130, 246, 0.9),
        0 0 15px 2px rgba(59, 130, 246, 0.3);
      transform: scale(1);
    }
    50% {
      box-shadow:
        0 10px 28px rgba(0, 0, 0, 0.6),
        inset 0 0 0 1px rgba(255, 255, 255, 0.15),
        0 0 0 16px rgba(59, 130, 246, 0.5),
        0 0 35px 8px rgba(59, 130, 246, 0.4);
      transform: scale(1.03);
    }
  }

  .audio-recorder__mic.should-flash {
    animation: mic-pulse 1.6s ease-in-out infinite;
  }

  .audio-recorder__mic:disabled {
    cursor: not-allowed;
    opacity: 0.6;
    filter: grayscale(20%);
    box-shadow:
      0 4px 14px rgba(0, 0, 0, 0.35),
      inset 0 0 0 1px rgba(255, 255, 255, 0.06);
  }
  .audio-recorder__mic:disabled:hover {
    box-shadow:
      0 4px 14px rgba(0, 0, 0, 0.35),
      inset 0 0 0 1px rgba(255, 255, 255, 0.06);
  }
  .audio-recorder__mic:disabled:active {
    transform: none;
  }

  .audio-recorder__mic.is-recording::after {
    content: '';
    position: absolute;
    inset: -8px;
    border-radius: 50%;
    box-shadow:
      0 0 0 4px rgba(239, 68, 68, 0.35),
      0 0 0 8px rgba(239, 68, 68, 0.18);
    animation: pulse 1.2s ease-out infinite;
  }

  @keyframes pulse {
    0% {
      box-shadow:
        0 0 0 0 rgba(239, 68, 68, 0.45),
        0 0 0 6px rgba(239, 68, 68, 0.22);
    }
    70% {
      box-shadow:
        0 0 0 6px rgba(239, 68, 68, 0),
        0 0 0 12px rgba(239, 68, 68, 0);
    }
    100% {
      box-shadow:
        0 0 0 0 rgba(239, 68, 68, 0),
        0 0 0 0 rgba(239, 68, 68, 0);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .audio-recorder__mic.is-recording::after {
      animation: none;
    }
  }

  .audio-recorder__mic__glyph {
    width: calc(var(--size) * 0.45);
    height: calc(var(--size) * 0.45);
  }

  .audio-recorder__mic__power {
    position: absolute;
    top: 10%;
    right: 18%;
    width: calc(var(--size) * 0.1);
    height: calc(var(--size) * 0.1);
    min-width: 0.45rem;
    min-height: 0.45rem;
    border-radius: 50%;
    background: #7f1d1d; /* off */
    box-shadow: 0 0 6px rgba(127, 29, 29, 0.4);
    transition:
      background 160ms ease,
      box-shadow 160ms ease;
  }
  .audio-recorder__mic:disabled .audio-recorder__mic__power {
    background: #374151;
    box-shadow: none;
  }
  .audio-recorder__mic.is-recording .audio-recorder__mic__power {
    background: #ef4444; /* on */
    box-shadow: 0 0 10px rgba(239, 68, 68, 0.9);
  }

  .audio-recorder__mic__shortcut {
    /* Component-specific positioning and sizing */
    position: absolute;
    bottom: 8%;
    right: 8%;
    font-size: clamp(0.49rem, 0.9vw, 0.56rem);
    padding: 0.15rem 0.3rem;
    border-radius: 0.15rem;

    /* Component-specific appearance variations */
    background: rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.25);
    color: rgba(255, 255, 255, 0.9);
    pointer-events: none;
  }

  .audio-recorder__status {
    display: flex;
    gap: 1rem;
    font-variant-numeric: tabular-nums;
    font-size: clamp(0.71rem, 1.35vw, 0.9rem);
    transition:
      color 200ms ease,
      text-shadow 200ms ease;
  }

  .audio-recorder__status--ready {
    color: rgb(212, 175, 55);
    /* color: #4ade80; */
    font-weight: 600;
    text-shadow: 0 0 8px rgba(74, 222, 128, 0.4);
  }

  .audio-recorder__status__duration {
    font-variant-numeric: tabular-nums;
  }

  .audio-recorder__waveform {
    position: relative;
    border-radius: 0.56rem;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(0, 0, 0, 0.25));
    padding: 0.94rem;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.08);
    overflow: hidden;
    touch-action: none; /* enable scrubbing on touch devices inside modal */
    min-height: 7.5rem; /* More compact for constrained space */
    height: auto;
    flex-shrink: 1;
    width: 100%;
    box-sizing: border-box;
  }

  .audio-recorder__waveform.is-seekable {
    cursor: ew-resize;
  }
  .audio-recorder__waveform canvas {
    width: 100%;
    height: 6rem;
    display: block;
    touch-action: none;
    pointer-events: none;
  }

  .audio-recorder__waveform__empty {
    position: absolute;
    inset: 0;
    display: grid;
    place-items: center;
    color: rgba(255, 255, 255, 0.75);
    font-size: clamp(0.71rem, 1.35vw, 0.86rem);
    text-align: center;
    pointer-events: none;
    backdrop-filter: none;
  }

  .audio-recorder__playhead {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 2px;
    background: #3b82f6;
    box-shadow: 0 0 6px rgba(59, 130, 246, 0.6);
    transform: translateX(-1px);
    pointer-events: none;
  }

  .shared-textarea.audio-recorder__transcript {
    width: 100%;
    box-sizing: border-box;
    flex-shrink: 1;
    min-height: 45px;
    max-height: 112px;
    overflow: hidden;
    resize: none;
  }

  .audio-recorder__transcript p {
    opacity: 0.9;
    font-size: clamp(0.71rem, 1.35vw, 0.83rem);
    line-height: 1.6;
  }

  .audio-recorder__controls {
    display: flex;
    gap: 0.75rem;
    justify-content: center;
    /* TODO: haven't decided on this */
    /* flex-wrap: wrap; */
    width: 100%;
  }

  .audio-btn {
    padding: 0.6rem 1.125rem;
    border-radius: 0.45rem;
    border: 1px solid rgba(255, 255, 255, 0.15);
    background: #2a2a2a;
    color: #fff; /* Always white text on dark buttons for proper contrast */
    cursor: pointer;
    transition:
      background 140ms ease,
      transform 100ms ease,
      box-shadow 140ms ease,
      border-color 140ms ease;
    font-size: clamp(0.71rem, 1.35vw, 0.79rem);
  }
  .audio-btn:hover {
    background: #333;
  }
  .audio-btn:active {
    transform: translateY(1px);
  }
  .audio-btn:focus-visible {
    outline: 3px solid #3b82f6;
    outline-offset: 3px;
  }
  .audio-btn:disabled {
    cursor: not-allowed;
    opacity: 0.6;
  }
  .audio-btn--primary {
    background: #1f2937;
    border-color: rgba(59, 130, 246, 0.45);
  }
  .audio-btn--primary:hover {
    background: #263247;
  }
  .audio-btn--danger {
    background: #3a1f1f;
    border-color: rgba(239, 68, 68, 0.45);
  }
  .audio-btn--danger svg {
    min-width: 0.94rem;
  }
  .audio-btn--danger:hover {
    background: #4a2626;
  }

  .audio-btn--with-shortcut {
    display: flex;
    align-items: center;
    gap: 0.56rem;
    padding-right: 0.75rem;
  }

  .audio-btn--danger.audio-btn--with-shortcut {
    position: relative;
    padding: 0.6rem 1.125rem;
  }

  .audio-btn--danger.audio-btn--with-shortcut .audio-btn__shortcut {
    position: absolute;
    bottom: 0.225rem;
    right: 0.225rem;
    font-size: 0.49rem;
    padding: 0.11rem 0.225rem;
  }

  .audio-btn__label {
    flex: 1;
  }

  .audio-btn__shortcut {
    /* Component-specific sizing */
    font-size: 0.56rem;
    padding: 0.19rem 0.375rem;
    border-radius: 0.19rem;

    /* Component-specific appearance variations */
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.85);
    text-transform: capitalize;
  }

  .audio-btn:disabled .audio-btn__shortcut {
    opacity: 0.4;
  }

  @keyframes pulse-glow {
    0%,
    100% {
      box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
      border-color: rgba(59, 130, 246, 0.45);
    }
    50% {
      box-shadow: 0 0 15px 3px rgba(59, 130, 246, 0.4);
      border-color: rgba(59, 130, 246, 0.9);
    }
  }

  .audio-btn--flash {
    animation: pulse-glow 1.5s ease-in-out infinite;
  }

  .audio-recorder__error {
    color: #fca5a5;
  }

  /* Speech status indicator for transcription feedback */
  .speech-status {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    margin-top: 0.5rem;
    border-radius: 6px;
    font-size: 0.875rem;
    line-height: 1.4;
    animation: fade-in 0.2s ease-out;
  }

  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(-4px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .speech-status--warning {
    background: rgba(251, 191, 36, 0.15);
    border: 1px solid rgba(251, 191, 36, 0.3);
    color: #fbbf24;
  }

  .speech-status--error {
    background: rgba(239, 68, 68, 0.15);
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: #fca5a5;
  }

  .speech-status__icon {
    font-size: 1rem;
    flex-shrink: 0;
  }

  .speech-status__message {
    flex: 1;
  }

  .speech-status__dismiss {
    background: none;
    border: none;
    padding: 0.25rem;
    color: inherit;
    opacity: 0.7;
    cursor: pointer;
    font-size: 0.75rem;
    line-height: 1;
    border-radius: 4px;
    transition: opacity 0.15s ease;
  }

  .speech-status__dismiss:hover {
    opacity: 1;
    background: rgba(255, 255, 255, 0.1);
  }

  /* Mobile modal */
  .audio-recorder__launcher {
    position: absolute;
    bottom: 1.125rem;
    right: 1.125rem;
    width: 3.375rem;
    height: 3.375rem;
    border-radius: 999px;
    border: 2px solid rgba(255, 255, 255, 0.25);
    /* Metallic grey gradient similar to meter components */
    background: radial-gradient(circle at 35% 35%, #8a8a8a, #5a5a5a 50%, #3a3a3a 100%);
    color: #fff; /* Always white icon on dark button for proper contrast */
    /* Elevated button-like shadow */
    box-shadow:
      0 6px 16px rgba(0, 0, 0, 0.6),
      inset 0 2px 4px rgba(255, 255, 255, 0.2),
      inset 0 -2px 6px rgba(0, 0, 0, 0.4);
    cursor: pointer;
    display: grid;
    place-items: center;
    z-index: 10;
    transition:
      transform 120ms ease,
      box-shadow 160ms ease;
  }

  .audio-recorder__launcher:hover {
    transform: translateY(-1px);
    box-shadow:
      0 8px 20px rgba(0, 0, 0, 0.7),
      inset 0 2px 4px rgba(255, 255, 255, 0.25),
      inset 0 -2px 6px rgba(0, 0, 0, 0.4);
  }
  .audio-recorder__launcher:active {
    transform: translateY(1px) scale(0.98);
    box-shadow:
      0 4px 12px rgba(0, 0, 0, 0.5),
      inset 0 1px 3px rgba(0, 0, 0, 0.5);
  }
  .audio-recorder__launcher:focus-visible {
    outline: 3px solid #3b82f6;
    outline-offset: 3px;
  }
  .audio-recorder__launcher.is-hidden {
    display: none;
  }

  .audio-recorder__modal {
    position: fixed;
    inset: 0;
    z-index: 50;
    display: flex;
    align-items: flex-start;
    justify-content: center;
  }
  .audio-recorder__backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(2px);
    z-index: 1;
  }

  /* Remove GPU-intensive backdrop-filter for reduced motion preference or low-end devices */
  @media (prefers-reduced-motion: reduce) {
    .audio-recorder__backdrop {
      backdrop-filter: none;
      background: rgba(0, 0, 0, 0.65); /* Slightly darker to compensate for missing blur */
    }
  }

  /* Hide meter display when modal is open to prevent visual bleed-through */
  body:has(.audio-recorder__modal) .meter__display {
    visibility: hidden;
  }
  .audio-recorder__modal__content {
    position: relative;
    z-index: 2;
    margin: 0 auto;
    width: 100%;
    height: 100%;
    max-width: 36rem;
    background: var(--clr-secondary);
    padding: 1.125rem;
    padding-top: 3.75rem;
    overflow: auto;
    overscroll-behavior: contain; /* keep touch interactions local (helps scrubbing) */
  }
  .audio-recorder__modal__header {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    margin-bottom: 1.5rem;
  }

  .close-btn {
    padding: 0.49rem;
    border-radius: 0.56rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: linear-gradient(145deg, #3a3a3a, #2a2a2a);
    color: #fff; /* Always white text on dark buttons for proper contrast */
    cursor: pointer;
    display: grid;
    place-items: center;
    transition:
      background 140ms ease,
      transform 100ms ease,
      box-shadow 140ms ease,
      border-color 140ms ease;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    min-width: 2.06rem;
    min-height: 2.06rem;
  }

  .close-btn:hover {
    background: linear-gradient(145deg, #4a4a4a, #333);
    border-color: rgba(255, 255, 255, 0.3);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
    transform: translateY(-1px);
  }

  .close-btn:active {
    transform: translateY(0);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }

  .close-btn:focus-visible {
    outline: 3px solid #3b82f6;
    outline-offset: 3px;
  }

  .close-btn svg {
    width: 18px;
    height: 18px;
  }

  /* Make modal content larger - Audio Recorder */
  .audio-recorder__modal .audio-recorder {
    gap: 1.31rem;
  }

  .audio-recorder__modal .audio-recorder__mic {
    --size: clamp(4.5rem, 12vw, 6.75rem);
  }

  .audio-recorder__modal .audio-recorder__status {
    font-size: clamp(1.05rem, 3vw, 1.39rem);
  }

  .audio-recorder__modal .audio-recorder__waveform {
    padding: 1.5rem;
    min-height: 10.5rem;
  }

  .audio-recorder__modal .audio-recorder__waveform canvas {
    height: 9rem;
  }

  .audio-recorder__modal .audio-recorder__waveform__empty {
    font-size: clamp(1.01rem, 2.625vw, 1.24rem);
  }

  .audio-recorder__modal .audio-recorder__transcript p {
    font-size: clamp(1.01rem, 2.625vw, 1.24rem);
    line-height: 1.7;
  }

  .audio-recorder__modal .audio-btn {
    padding: 0.75rem 1.5rem;
    font-size: clamp(1.01rem, 2.625vw, 1.2rem);
    border-radius: 0.56rem;
  }

  .audio-recorder__modal .audio-recorder__controls {
    gap: 1.125rem;
  }

  .audio-recorder__modal .audio-recorder__error {
    font-size: clamp(0.94rem, 2.25vw, 1.125rem);
    padding: 0.75rem;
  }

  .audio-recorder__modal .speech-status {
    font-size: clamp(0.875rem, 2vw, 1rem);
    padding: 0.625rem 0.875rem;
    margin-top: 0.75rem;
  }

  /* Make modal content larger - Text Input */
  .audio-recorder__modal .text-input {
    gap: 1.31rem;
    height: 100%;
    justify-content: center;
  }

  /* Modal text input overrides - moved to end of file after base styles */

  /* Hide jack/port in mobile modals */
  .audio-recorder__modal .input-container__port {
    display: none;
  }

  /* Also hide jack when modal is open (since jack is position:fixed, it's outside modal) */
  /* Fallback for browsers without :has() support: use a class on body */
  .modal-open .input-container__port {
    display: none;
  }

  .meter {
    position: relative;
    aspect-ratio: var(--meter-aspect-ratio);
    width: min(
      100% - var(--meter-padding),
      (100svh - var(--meter-padding)) * var(--meter-aspect-ratio)
    );

    display: flex;
    flex-direction: column;

    /* Vintage bakelite housing with wood grain undertones */
    background:
      /* Fine wood grain texture */
      repeating-linear-gradient(
        87deg,
        transparent 0px,
        transparent 2px,
        rgba(139, 90, 43, 0.03) 2px,
        rgba(139, 90, 43, 0.03) 3px
      ),
      /* Subtle noise texture */
        url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E"),
      /* Deep bakelite gradient */
        linear-gradient(175deg, #3d3632 0%, #2a2520 25%, #1f1c19 50%, #2a2520 75%, #1f1c19 100%);
    border-radius: var(--border-radius-primary);

    /* Layered vintage shadows for depth */
    box-shadow:
      /* Outer glow - subtle warmth */
      0 0 40px rgba(139, 90, 43, 0.1),
      /* Heavy drop shadow */ 0 20px 50px rgba(0, 0, 0, 0.5),
      0 8px 25px rgba(0, 0, 0, 0.4),
      /* Inner edge highlights */ inset 0 1px 0 rgba(255, 255, 255, 0.08),
      inset 0 -1px 0 rgba(0, 0, 0, 0.3),
      /* Subtle inner glow from display */ inset 0 0 60px rgba(247, 243, 227, 0.03);

    /* Metallic edge trim */
    border: 1px solid rgba(139, 115, 85, 0.3);

    padding-top: 1.875rem;
    > *:not(.meter__title) {
      flex: 1 1 0;
    }

    /* Brass corner accents */
    &::before,
    &::after {
      content: '';
      position: absolute;
      width: 9px;
      height: 9px;
      border-radius: 50%;
      background: radial-gradient(
        circle at 35% 35%,
        #d4af37 0%,
        #b8860b 40%,
        #8b6914 70%,
        #5c4a1f 100%
      );
      box-shadow:
        inset 0 1px 2px rgba(255, 255, 255, 0.4),
        inset 0 -1px 2px rgba(0, 0, 0, 0.4),
        0 2px 4px rgba(0, 0, 0, 0.4);
      z-index: 10;
    }

    &::before {
      top: 9px;
      left: 9px;
    }

    &::after {
      top: 9px;
      right: 9px;
    }
  }

  .meter__title {
    display: none; /* Hidden on desktop */
    flex: 0 0 auto; /* Ensure title doesn't stretch */
    font-family: 'Playfair Display', Georgia, serif;
    color: #d4af37;
    text-shadow:
      0 2px 0 rgba(0, 0, 0, 0.6),
      0 -1px 0 rgba(255, 223, 150, 0.2),
      0 0 15px rgba(212, 175, 55, 0.25);
  }

  /* Mobile launcher portal container */
  .mobile-launcher-portal {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none; /* Allow clicks through to meter */
  }

  .mobile-launcher-portal > * {
    pointer-events: auto; /* But allow clicks on the button itself */
  }

  /* Unreliable prediction warning banner */
  .meter__warning {
    position: absolute;
    bottom: 0.75rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: rgba(180, 83, 9, 0.95);
    border: 1px solid rgba(245, 158, 11, 0.5);
    border-radius: 0.375rem;
    color: #fef3c7;
    font-size: 0.75rem;
    font-family: 'Libre Baskerville', Georgia, serif;
    white-space: nowrap;
    z-index: 20;
    box-shadow:
      0 4px 12px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
    animation: warning-fade-in 0.3s ease-out;
  }

  .meter__warning svg {
    flex-shrink: 0;
    color: #fbbf24;
  }

  @keyframes warning-fade-in {
    from {
      opacity: 0;
      transform: translateX(-50%) translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
  }

  .meter__display {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(4, 1fr);
    /* Prevent sub-pixel gaps between grid cells */
    gap: 0;

    border-radius: 4px;
    overflow: hidden;

    /* Consistent vintage meter face color - warm aged ivory/cream */
    --meter-face-color: #f5f1e4;
    background-color: var(--meter-face-color);

    /* Deeply recessed display with brass bezel */
    box-shadow:
      /* Outer brass frame edge */
      inset 0 0 0 4px #9a7850,
      inset 0 0 0 5px #6b5538,
      inset 0 0 0 6px rgba(0, 0, 0, 0.3),
      /* Deep recess shadow */ inset 0 10px 25px rgba(0, 0, 0, 0.22),
      inset 0 -4px 12px rgba(255, 250, 235, 0.3),
      inset 8px 0 18px rgba(0, 0, 0, 0.12),
      inset -8px 0 18px rgba(0, 0, 0, 0.12);

    /* Glass cover border */
    border: 1px solid rgba(60, 50, 35, 0.5);

    /* Glass effect pseudo-element */
    position: relative;
    &::before {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 100;
      /* Glass glare diagonal streak */
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.15) 0%,
        rgba(255, 255, 255, 0.06) 20%,
        transparent 35%,
        transparent 100%
      );
      border-radius: inherit;
    }
  }

  .meter__controls {
    display: grid;
    place-items: center;
  }

  .meter__display__boundary {
    width: 100%;
    height: 100%;
    grid-row: 1 / 5;
    /* Use the same solid color as display */
    background-color: var(--meter-face-color, #f5f1e4);
    z-index: 1;
  }

  .meter__display__boundary--left {
    grid-column: 1 / 2;
    clip-path: polygon(0 0, 100% 100%, 0 100%);
  }

  .meter__display__boundary--right {
    grid-column: 3 / 4;
    clip-path: polygon(100% 0, 100% 100%, 0 100%);
  }

  .meter__display__level {
    grid-column: 1 / -1;

    width: 100%;
    height: 100%;

    background: var(--level-color);
    clip-path: ellipse(50% 100% at bottom center);

    /* Position above the level indicators */
    position: relative;
    z-index: 1;
  }

  .meter__display__level--prosodic {
    /* Deep vintage cardinal red with gradient */
    --level-color: linear-gradient(
      90deg,
      #8a1828 0%,
      #a82035 30%,
      #c41e3a 50%,
      #a82035 70%,
      #8a1828 100%
    );
    background: var(--level-color);
    grid-row: 2 / 3;
  }

  .meter__display__level--lexical {
    /* Rich amber/bronze with gradient */
    --level-color: linear-gradient(
      90deg,
      #7a5020 0%,
      #9a6930 30%,
      #c9923e 50%,
      #9a6930 70%,
      #7a5020 100%
    );
    background: var(--level-color);
    grid-row: 3 / 4;
  }

  .meter__display__ticks__wrapper {
    position: relative;

    width: 100%;
    height: 100%;

    display: flex;
    justify-content: space-between;
    /* Use the same solid color as display */
    background-color: var(--meter-face-color, #f5f1e4);
    clip-path: ellipse(
      calc(50% - var(--meter-level-thickness)) calc(100% - var(--meter-level-thickness)) at bottom
        center
    );
  }

  .meter__display__ticks__wrapper::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;

    /* Use the same solid color as display */
    background-color: var(--meter-face-color, #f5f1e4);
    clip-path: ellipse(
      calc(50% - var(--meter-level-thickness) * 2) calc(100% - var(--meter-level-thickness) * 2) at
        bottom center
    );
  }

  .meter__tick {
    top: 0;
    left: 0;
    width: var(--meter-tick-width);
    height: 100%;
    /* Classic dark tick marks */
    background: #2a2520;
  }

  .meter__needle__holder {
    position: relative;
    bottom: -5px;
    grid-column: 2 / 3;
    grid-row: 4 / 5;

    width: 100%;
    height: 100%;

    /* Vintage brass pivot mount with patina */
    background:
      /* Dome highlight */
      radial-gradient(
        ellipse 60% 45% at 50% 30%,
        rgba(255, 223, 150, 0.6) 0%,
        rgba(255, 223, 150, 0.2) 40%,
        transparent 70%
      ),
      /* Machined concentric rings - brass */
        repeating-radial-gradient(
          circle at 50% 100%,
          transparent 0px,
          transparent 2px,
          rgba(92, 74, 50, 0.25) 2px,
          rgba(92, 74, 50, 0.25) 3px,
          rgba(255, 223, 150, 0.15) 3px,
          rgba(255, 223, 150, 0.15) 4px,
          transparent 4px,
          transparent 6px
        ),
      /* Inner detail rings */
        repeating-radial-gradient(
          circle at 50% 100%,
          transparent 0px,
          transparent 1px,
          rgba(92, 74, 50, 0.12) 1px,
          rgba(92, 74, 50, 0.12) 2px,
          transparent 2px,
          transparent 3px
        ),
      /* Rich brass gradient with aged patina hints */
        radial-gradient(
          ellipse 95% 75% at 50% 115%,
          #d4af37 0%,
          #c9a227 20%,
          #b8960b 40%,
          #8b7355 60%,
          #6b5a45 80%,
          #4a3f32 100%
        );
    clip-path: circle(42% at bottom center);
    box-shadow:
      /* Deep inset shadows for dimension */
      inset 0 -4px 10px rgba(0, 0, 0, 0.5),
      inset 0 4px 6px rgba(255, 223, 150, 0.3),
      /* Outer ring shadow */ 0 4px 12px rgba(0, 0, 0, 0.6),
      0 2px 4px rgba(0, 0, 0, 0.4),
      /* Subtle brass glow */ 0 0 20px rgba(184, 134, 11, 0.15);
    z-index: 3;

    /* Central pivot screw */
    &::after {
      content: '';
      position: absolute;
      bottom: 15%;
      left: 50%;
      transform: translateX(-50%);
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: radial-gradient(
        circle at 35% 35%,
        #f4e4bc 0%,
        #d4af37 30%,
        #8b6914 60%,
        #4a3520 100%
      );
      box-shadow:
        inset 0 -1px 2px rgba(0, 0, 0, 0.5),
        0 1px 2px rgba(0, 0, 0, 0.4);
    }
  }

  .meter__needle {
    grid-column: 2 / 3;
    grid-row: 1 / 5;

    width: 12px;
    height: 92%;

    margin-block-start: auto;
    margin-inline: auto;

    /* Classic blued steel needle */
    background: linear-gradient(
      90deg,
      #0a0a12 0%,
      #1a1a28 25%,
      #2a2a3a 50%,
      #1a1a28 75%,
      #0a0a12 100%
    );
    transform-origin: 50% 100%;
    transform: rotate(var(--needle-rotation, -55deg));
    z-index: 2;

    /* Needle shadow for depth */
    box-shadow:
      2px 2px 6px rgba(0, 0, 0, 0.5),
      0 0 1px rgba(0, 0, 0, 0.6);
    transition: transform var(--anim-duration, 1400ms) cubic-bezier(0.25, 0.1, 0.25, 1);

    /* Elegant tapered needle shape */
    clip-path: polygon(35% 1.5%, 50% 0%, 65% 1.5%, 56% 10%, 56% 100%, 44% 100%, 44% 10%);

    /* Red tip indicator */
    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 15%;
      background: linear-gradient(to bottom, #c41e3a 0%, #8b1428 60%, transparent 100%);
      clip-path: polygon(0% 0%, 100% 0%, 80% 100%, 20% 100%);
    }
  }

  /* ========================================
     METER POWER STATES & ANIMATIONS
     ======================================== */

  /* Power OFF state - cold, unlit display */
  .meter--off .meter__display {
    --meter-face-color: #e0dcd0;
    background-color: var(--meter-face-color);
    filter: saturate(0.35) brightness(0.9);
  }

  .meter--off .meter__needle {
    transform: rotate(-55deg) !important;
    transition: none;
    opacity: 0.7;
  }

  .meter--off .meter__needle::before {
    opacity: 0.5;
  }

  .meter--off .level-indicator {
    opacity: 0.3;
  }

  /* Power ON state - warm incandescent tube glow */
  .meter__display--backlit {
    /* Warmer cream when backlit */
    --meter-face-color: #faf6eb;
    background-color: var(--meter-face-color);
    box-shadow:
      /* Brass bezel glowing */
      inset 0 0 0 4px #b89060,
      inset 0 0 0 5px #7a6040,
      inset 0 0 0 6px rgba(0, 0, 0, 0.25),
      /* Recessed shadows - softened for glow */ inset 0 8px 20px rgba(0, 0, 0, 0.1),
      inset 0 -4px 12px rgba(255, 250, 235, 0.35),
      inset 6px 0 15px rgba(0, 0, 0, 0.05),
      inset -6px 0 15px rgba(0, 0, 0, 0.05),
      /* Warm incandescent backlight glow */ inset 0 0 100px rgba(255, 230, 170, 0.4),
      inset 0 0 50px rgba(255, 215, 140, 0.3),
      /* Outer warm glow */ 0 0 35px rgba(255, 215, 140, 0.2);
    /* Hint browser to optimize for box-shadow changes (promotes to own layer) */
    will-change: box-shadow;
    animation: backlight-pulse 8s ease-in-out infinite;
  }

  /* Disable animation for users who prefer reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .meter__display--backlit {
      animation: none;
      will-change: auto;
    }
  }

  @keyframes backlight-pulse {
    0%,
    100% {
      box-shadow:
        inset 0 0 0 4px #b89060,
        inset 0 0 0 5px #7a6040,
        inset 0 0 0 6px rgba(0, 0, 0, 0.25),
        inset 0 8px 20px rgba(0, 0, 0, 0.1),
        inset 0 -4px 12px rgba(255, 250, 235, 0.35),
        inset 6px 0 15px rgba(0, 0, 0, 0.05),
        inset -6px 0 15px rgba(0, 0, 0, 0.05),
        inset 0 0 100px rgba(255, 230, 170, 0.4),
        inset 0 0 50px rgba(255, 215, 140, 0.3),
        0 0 35px rgba(255, 215, 140, 0.2);
    }
    50% {
      box-shadow:
        inset 0 0 0 4px #c9a070,
        inset 0 0 0 5px #8a7050,
        inset 0 0 0 6px rgba(0, 0, 0, 0.2),
        inset 0 8px 20px rgba(0, 0, 0, 0.06),
        inset 0 -4px 12px rgba(255, 250, 235, 0.45),
        inset 6px 0 15px rgba(0, 0, 0, 0.04),
        inset -6px 0 15px rgba(0, 0, 0, 0.04),
        inset 0 0 120px rgba(255, 235, 180, 0.5),
        inset 0 0 60px rgba(255, 220, 150, 0.4),
        0 0 45px rgba(255, 220, 150, 0.25);
    }
  }

  /* Power-on animation - vacuum tube warm-up effect */
  .meter--powering-on .meter__display--backlit {
    animation: backlight-fade-in 450ms ease-out forwards;
  }

  @keyframes backlight-fade-in {
    0% {
      filter: saturate(0.4) brightness(0.92);
      box-shadow:
        inset 0 0 0 3px #8b7355,
        inset 0 0 0 4px #5c4a32,
        inset 0 8px 20px rgba(0, 0, 0, 0.25);
    }
    30% {
      filter: saturate(0.7) brightness(0.96);
    }
    100% {
      filter: saturate(1) brightness(1);
      box-shadow:
        inset 0 0 0 4px #b89060,
        inset 0 0 0 5px #7a6040,
        inset 0 0 0 6px rgba(0, 0, 0, 0.25),
        inset 0 8px 20px rgba(0, 0, 0, 0.1),
        inset 0 -4px 12px rgba(255, 250, 235, 0.35),
        inset 6px 0 15px rgba(0, 0, 0, 0.05),
        inset -6px 0 15px rgba(0, 0, 0, 0.05),
        inset 0 0 100px rgba(255, 230, 170, 0.4),
        inset 0 0 50px rgba(255, 215, 140, 0.3),
        0 0 35px rgba(255, 215, 140, 0.2);
    }
  }

  /* Power-on needle stutter animation */
  .meter__needle--powering-on {
    animation: needle-stutter 700ms ease-out forwards;
  }

  @keyframes needle-stutter {
    0% {
      transform: rotate(var(--needle-rotation, -90deg));
    }
    15% {
      transform: rotate(calc(var(--needle-rotation, -90deg) + 8deg));
    }
    30% {
      transform: rotate(calc(var(--needle-rotation, -90deg) - 5deg));
    }
    45% {
      transform: rotate(calc(var(--needle-rotation, -90deg) + 4deg));
    }
    60% {
      transform: rotate(calc(var(--needle-rotation, -90deg) - 3deg));
    }
    75% {
      transform: rotate(calc(var(--needle-rotation, -90deg) + 2deg));
    }
    100% {
      transform: rotate(var(--needle-rotation, -90deg));
    }
  }

  /* Loading state - needle jitter */
  .meter__needle--loading {
    animation: needle-loading-jitter 500ms ease-in-out infinite;
  }

  @keyframes needle-loading-jitter {
    0%,
    100% {
      transform: rotate(var(--needle-rotation, -90deg));
    }
    25% {
      transform: rotate(calc(var(--needle-rotation, -90deg) + 3deg));
    }
    50% {
      transform: rotate(calc(var(--needle-rotation, -90deg) - 2deg));
    }
    75% {
      transform: rotate(calc(var(--needle-rotation, -90deg) + 2deg));
    }
  }

  /* Disable needle jitter for users who prefer reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .meter__needle--loading {
      animation: none;
    }
  }

  /* ========================================
     SCALE LABELS
     ======================================== */

  .meter__display__scale-labels {
    position: absolute;
    top: 5%;
    left: 0;
    right: 0;
    display: flex;
    justify-content: space-between;
    padding: 0 10%;
    z-index: 5;
    pointer-events: none;
  }

  .meter__display__scale-label {
    font-family: 'Playfair Display', Georgia, serif;
    font-size: clamp(0.45rem, 1.3vw, 0.65rem);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    /* Engraved text appearance */
    color: #3d352d;
    text-shadow:
      0 1px 0 rgba(255, 255, 255, 0.5),
      0 -0.5px 0 rgba(0, 0, 0, 0.15);
  }

  .meter__display__scale-label--left {
    text-align: left;
  }

  .meter__display__scale-label--right {
    text-align: right;
  }

  /* ========================================
     CURVED LABELS FOR METERS
     ======================================== */

  .meter__display-wrapper {
    position: relative;
    margin-block-start: var(--meter-display-margin);
    margin-inline: var(--meter-display-margin);
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
  }

  .meter__display-wrapper .meter__display {
    flex: 1 1 auto;
  }

  .meter__curved-label {
    position: absolute;
    left: 8%;
    right: 8%;
    width: 84%;
    height: 14%;
    pointer-events: none;
    z-index: 10;
    overflow: visible;
    filter: drop-shadow(0 1px 0 rgba(255, 255, 255, 0.4));
  }

  .meter__curved-label__text {
    font-family: 'Playfair Display', Georgia, serif;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    fill: currentColor;
  }

  .meter__curved-label__text .italic {
    font-style: italic;
    font-weight: 400;
  }

  .meter__curved-label--prosodic {
    color: #8b1e3a; /* Deep vintage red */
    top: 31%;
  }

  .meter__curved-label--lexical {
    color: #8b5a2b; /* Aged bronze */
    top: 56%;
  }

  .meter__curved-label--disabled {
    color: #8a8578 !important;
    filter: none;
  }

  /* ========================================
     LEVEL METER STATES (ENABLED/DISABLED)
     ======================================== */

  .meter__display__level--disabled.meter__display__level--prosodic,
  .meter__display__level--disabled.meter__display__level--lexical {
    --level-color: #9a958c;
  }

  .meter__display__level--disabled .meter__tick {
    background: #a5a095;
  }

  /* ========================================
     SVG-BASED LEVEL INDICATORS
     ======================================== */

  .level-indicators-container {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 2; /* In front so indicators are visible */
  }

  .level-indicators-svg {
    width: 100%;
    height: 100%;
    overflow: visible;
  }

  .level-indicator {
    filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.5));
  }

  .level-indicator__body {
    filter: brightness(1);
  }

  .level-indicator--disabled {
    /* Color is handled in component via gradient fill */
    opacity: 0.85;
  }

  /* Loading animation for SVG indicators */
  .level-indicator--loading {
    animation: svg-indicator-jitter 500ms ease-in-out infinite;
  }

  @keyframes svg-indicator-jitter {
    0%,
    100% {
      filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.5));
    }
    25% {
      filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.5));
    }
    50% {
      filter: drop-shadow(-1px 2px 3px rgba(0, 0, 0, 0.5));
    }
    75% {
      filter: drop-shadow(1px 2px 3px rgba(0, 0, 0, 0.5));
    }
  }

  /* Disable indicator jitter for users who prefer reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .level-indicator--loading {
      animation: none;
    }
  }

  /* Power-on stutter for SVG indicators */
  .level-indicator--powering-on {
    animation: svg-indicator-stutter 700ms ease-out forwards;
  }

  @keyframes svg-indicator-stutter {
    0%,
    100% {
      filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.5)) brightness(1);
    }
    15% {
      filter: drop-shadow(3px 2px 3px rgba(0, 0, 0, 0.5)) brightness(1.2);
    }
    30% {
      filter: drop-shadow(-2px 2px 3px rgba(0, 0, 0, 0.5)) brightness(0.9);
    }
    50% {
      filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.5)) brightness(1.1);
    }
    70% {
      filter: drop-shadow(-1px 2px 3px rgba(0, 0, 0, 0.5)) brightness(1);
    }
  }

  /* ========================================
     METER DISPLAY POSITION ADJUSTMENTS
     ======================================== */

  .meter__display {
    position: relative;
  }

  /* Rotary switch - vintage Bakelite style */
  .rotary {
    /* Responsive dial sizing */
    --size: clamp(9rem, 30vw, 15rem);
    --radius: calc(var(--size) * 0.42);
    --icon-size: clamp(1.125rem, calc(var(--size) * 0.12), 2.1rem);
    --accent: #d4af37;

    position: relative;
    display: grid;
    place-items: center;
    width: var(--size);
    height: var(--size);
    padding: 0;
    border: none;
    background: transparent;
    cursor: pointer;
  }

  .rotary:focus-visible {
    outline: 3px solid var(--accent);
    outline-offset: 4px;
    border-radius: 50%;
  }

  .rotary__plate {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    /* Recessed mounting plate with brass ring */
    background:
      radial-gradient(
        circle at 50% 50%,
        rgba(0, 0, 0, 0.1) 45%,
        rgba(139, 115, 85, 0.3) 48%,
        rgba(139, 115, 85, 0.15) 52%,
        transparent 55%
      ),
      radial-gradient(ellipse at center, rgba(255, 255, 255, 0.08) 0%, rgba(0, 0, 0, 0.25) 100%);
    box-shadow:
      inset 0 4px 12px rgba(0, 0, 0, 0.45),
      inset 0 -2px 6px rgba(255, 255, 255, 0.05);
  }

  .rotary__knob {
    width: calc(var(--size) * 0.55);
    height: calc(var(--size) * 0.55);
    border-radius: 50%;
    /* Rich bakelite knob with depth */
    background:
      /* Top highlight dome */
      radial-gradient(ellipse 80% 60% at 40% 30%, rgba(80, 70, 60, 0.9) 0%, transparent 50%),
      /* Grip ridges suggestion */
        repeating-conic-gradient(
          from 0deg,
          rgba(255, 255, 255, 0.03) 0deg 6deg,
          transparent 6deg 12deg
        ),
      /* Main bakelite gradient */
        linear-gradient(155deg, #4a4540 0%, #3a3632 25%, #2a2825 50%, #1f1d1a 75%, #151412 100%);
    box-shadow:
      /* Outer ring shadow */
      0 8px 25px rgba(0, 0, 0, 0.6),
      0 4px 10px rgba(0, 0, 0, 0.4),
      /* Inner edge definition */ inset 0 2px 4px rgba(255, 255, 255, 0.08),
      inset 0 -3px 8px rgba(0, 0, 0, 0.4),
      /* Subtle brass edge ring */ 0 0 0 2px rgba(139, 115, 85, 0.2);
    transform: rotate(var(--angle-deg));
    transition:
      transform 180ms cubic-bezier(0.34, 1.2, 0.64, 1),
      box-shadow 150ms ease,
      filter 150ms ease;
  }
  /* Icons rendered around the dial at configured angles */
  .rotary__icon {
    position: absolute;
    top: calc(53% - var(--icon-size) / 2);
    left: calc(50% - var(--icon-size) / 2);
    --radial-adjust: 0px;
    /* Fallback placement using rotate + translate */
    transform: rotate(var(--deg)) translateY(calc(-1 * (var(--radius) + var(--radial-adjust))))
      rotate(calc(-1 * var(--deg)));
    transform-origin: center;
    color: rgba(212, 175, 55, 0.35);
    opacity: 1;
    transition:
      color 180ms ease,
      transform 160ms ease,
      filter 180ms ease;
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.5));
  }

  /* Prefer precise placement using trig functions when supported */
  @supports (transform: translate(calc(sin(0deg) * 1px), calc(cos(0deg) * 1px))) {
    .rotary__icon {
      transform: translate(
        calc(sin(var(--deg)) * (var(--radius) + var(--radial-adjust))),
        calc(-1 * cos(var(--deg)) * (var(--radius) + var(--radial-adjust)))
      ); /* stays upright without extra rotation */
    }
  }

  /* Per-icon optical centering tweaks */
  .rotary__icon--audio {
    --radial-adjust: -4px;
  }
  .rotary__icon--text {
    --radial-adjust: -4px;
  }

  .rotary__icon.is-active {
    color: #d4af37;
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.6)) drop-shadow(0 0 8px rgba(212, 175, 55, 0.4));
  }

  .rotary__icon__glyph {
    display: inline-grid;
    place-items: center;
    width: var(--icon-size);
    height: var(--icon-size);
  }

  /* Ensure inline SVGs scale with container */
  .rotary__icon__glyph svg {
    width: 100%;
    height: 100%;
  }

  /* Selected indicator line - brass inlay pointer */
  .rotary__knob::after {
    content: '';
    position: absolute;
    left: 50%;
    top: 8%;
    transform: translateX(-50%);
    width: 3px;
    height: calc(42%);
    border-radius: 2px 2px 1px 1px;
    /* Brass inlay effect */
    background: linear-gradient(
      to bottom,
      #f4e4bc 0%,
      #d4af37 15%,
      #b8960b 50%,
      #8b6914 85%,
      #5c4a1f 100%
    );
    box-shadow:
      inset 0 1px 1px rgba(255, 255, 255, 0.5),
      inset 0 -1px 2px rgba(0, 0, 0, 0.4),
      0 0 3px rgba(0, 0, 0, 0.4),
      0 1px 2px rgba(0, 0, 0, 0.3);
  }

  .rotary:hover .rotary__knob {
    filter: brightness(1.08);
    box-shadow:
      0 10px 30px rgba(0, 0, 0, 0.65),
      0 5px 12px rgba(0, 0, 0, 0.45),
      inset 0 2px 4px rgba(255, 255, 255, 0.1),
      inset 0 -3px 8px rgba(0, 0, 0, 0.4),
      0 0 0 2px rgba(184, 134, 11, 0.25);
  }

  .rotary__label {
    position: absolute;
    bottom: calc(var(--size) * -0.12);
    font-family: 'Playfair Display', Georgia, serif;
    font-size: clamp(0.6rem, calc(var(--size) * 0.06), 0.75rem);
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: rgba(212, 175, 55, 0.8);
    text-shadow:
      0 1px 2px rgba(0, 0, 0, 0.7),
      0 0 8px rgba(212, 175, 55, 0.15);
    pointer-events: none;
  }
}

/* Input container styling (desktop) */
.input-container {
  position: relative;
  z-index: 2;
  padding: 1.5rem;
  padding-top: calc(1.5rem + 12px);
  border: 4px solid rgba(255, 255, 255, 0.2);
  border-radius: var(--border-radius-primary);
  background: rgba(0, 0, 0, 0.2);
  min-height: 255px;
  width: 100%; /* Fill the column naturally */
  transition: border-color 0.3s ease;
  box-sizing: border-box;
  overflow: visible;
}

/* Title + Input stack to reduce layout shift */
.stack {
  width: 100%;
  padding: 1.875rem;
  padding-top: calc(0.75rem + 15px);
  height: 100svh; /* full viewport height */
  display: grid;
  grid-template-rows: 1fr 4fr; /* title 1/4, input 3/4 */
  gap: 0.75rem;
  margin: 0 auto;
  align-items: center; /* center children within each half */
  box-sizing: border-box;
  max-width: 1050px;
  overflow-x: hidden; /* Prevent horizontal scroll */
  overflow-y: visible;
}

.stack .input-container {
  height: 100%; /* fill the bottom half fully */
  max-height: 100%; /* prevent exceeding parent */
  display: flex;
  flex-direction: column;
  justify-content: center; /* center contents vertically */
  overflow: visible;
  position: relative;
  margin: 0 auto; /* Center horizontally with fixed width */
}

/* Ensure content fits within container without causing scroll */
.stack .input-container > :not(.input-container__port) {
  max-height: 100%;
  overflow: visible;
  width: 100%;
  margin: 0;
  flex-shrink: 1;
}

/* View Transitions for input content switching */
.input-container__content {
  view-transition-name: input-content;
  width: 100%;
  max-height: 100%;
  overflow: visible;
}

@media (prefers-reduced-motion: no-preference) {
  ::view-transition-old(input-content),
  ::view-transition-new(input-content) {
    animation-duration: 350ms;
    animation-timing-function: ease-in-out;
  }

  ::view-transition-old(input-content) {
    animation-name: fade-out;
  }

  ::view-transition-new(input-content) {
    animation-name: fade-in;
  }

  @keyframes fade-out {
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  }

  @keyframes fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
}

.title-group {
  place-self: start center;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.375rem;
}

.title {
  font-family: 'Playfair Display', Georgia, serif;
  color: #d4af37; /* Brass gold */
  text-transform: uppercase;
  letter-spacing: 0.15em;
  font-weight: 900;
  font-size: clamp(0.94rem, 2.25vw, 2.06rem);
  padding: 0.375rem 0.75rem;
  /* Engraved brass nameplate effect */
  text-shadow:
    0 2px 0 rgba(0, 0, 0, 0.5),
    0 -1px 0 rgba(255, 223, 150, 0.3),
    0 0 15px rgba(212, 175, 55, 0.3),
    0 0 30px rgba(212, 175, 55, 0.15);
  background: linear-gradient(
    180deg,
    transparent 0%,
    rgba(212, 175, 55, 0.05) 50%,
    transparent 100%
  );
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
}

.subtitle {
  font-family: 'Libre Baskerville', Georgia, serif;
  color: rgba(212, 175, 55, 0.5);
  font-style: italic;
  letter-spacing: 0.1em;
  font-weight: 400;
  font-size: clamp(0.525rem, 1.125vw, 0.675rem);
  text-shadow:
    0 1px 0 rgba(0, 0, 0, 0.4),
    0 0 8px rgba(212, 175, 55, 0.1);
}

/* Getting Started */
.getting-started {
  max-width: 100%;
  width: 100%;
  max-height: 100%;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: clamp(0.56rem, 1.5vw, 1.125rem);
  overflow-wrap: break-word;
  word-wrap: break-word;
  overflow: hidden;
}

.getting-started * {
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
}

.getting-started__title {
  font-size: clamp(0.83rem, 2.625vw, 1.875rem);
  font-weight: bold;
  color: var(--clr-primary);
  text-align: center;
  line-height: 1.3;
  hyphens: auto;
}

.getting-started__intro {
  font-size: clamp(0.675rem, 1.875vw, 1.05rem);
  text-align: center;
  font-style: italic;
  opacity: 0.9;
  line-height: 1.5;
}

.getting-started__description {
  font-size: clamp(0.64rem, 1.5vw, 0.9rem);
  line-height: 1.7;
}

.getting-started__models {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: clamp(0.66rem, 1.5vw, 1.5rem);
  width: 100%;
}

.getting-started__model {
  font-size: clamp(0.64rem, 1.5vw, 0.86rem);
  padding-left: clamp(1.125rem, 1.875vw, 1.875rem);
  position: relative;
  line-height: 1.7;
}

.getting-started__model::before {
  content: '→';
  position: absolute;
  left: 0;
  color: var(--clr-primary);
  opacity: 0.7;
  font-size: 1.2em;
}

.getting-started__cta {
  font-size: clamp(0.64rem, 1.5vw, 0.9rem);
  line-height: 1.7;
  text-align: center;
  font-style: italic;
  opacity: 0.95;
  margin-top: clamp(0.375rem, 1.125vw, 0.75rem);
}

/* Text Input */
.text-input {
  width: 100%;
  margin: 0 auto;
  padding: 0.75rem;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  max-height: 100%;
  overflow: hidden;
}
.shared-textarea {
  width: 100%;
  max-width: 100%;
  min-height: 90px;
  max-height: 225px;
  padding: 0.94rem;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 6px;
  color: #fff; /* Always white text on dark background for proper contrast */
  font-size: clamp(0.71rem, 1.35vw, 0.83rem);
  resize: vertical;
  line-height: 1.6;
  transition: border-color 0.2s ease;
  box-sizing: border-box;
  flex: 1 1 auto;
  overflow: auto;
}

.shared-textarea:focus:not(:disabled) {
  outline: none;
  border-color: rgba(255, 255, 255, 0.4);
}
.shared-textarea:disabled {
  opacity: 0.85;
  cursor: not-allowed;
}

@keyframes textarea-pulse {
  0%,
  100% {
    border-color: rgba(255, 255, 255, 0.2);
    box-shadow:
      0 0 0 0 rgba(59, 130, 246, 0.9),
      0 0 10px 2px rgba(59, 130, 246, 0.15);
  }
  50% {
    border-color: rgba(59, 130, 246, 0.8);
    box-shadow:
      0 0 0 8px rgba(59, 130, 246, 0.4),
      0 0 25px 6px rgba(59, 130, 246, 0.25);
  }
}

.shared-textarea.should-flash {
  animation: textarea-pulse 1.6s ease-in-out infinite;
}
.text-input__controls {
  display: flex;
  justify-content: flex-end;
  margin-top: 0.75rem;
}
.text-input__send-btn {
  width: 100%;
  display: block;
  padding: 0.56rem 1.125rem;
  background: linear-gradient(145deg, #555, #333);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 6px;
  color: #fff; /* Always white text on dark buttons for proper contrast */
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}
.text-input__send-btn:hover:not(:disabled) {
  background: linear-gradient(145deg, #666, #444);
  border-color: rgba(255, 255, 255, 0.3);
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}
.text-input__send-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.text-input__send-btn--with-shortcut {
  display: flex;
  align-items: center;
  gap: 0.56rem;
  justify-content: space-between;
  padding-right: 0.75rem;
}

.text-input__send-btn__label {
  flex: 1;
}

.text-input__send-btn__shortcut {
  /* Component-specific sizing */
  font-size: 0.56rem;
  padding: 0.19rem 0.375rem;
  border-radius: 0.19rem;

  /* Component-specific appearance variations */
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.85);
  white-space: nowrap;
}

.text-input__send-btn:disabled .text-input__send-btn__shortcut {
  opacity: 0.4;
}

.text-input__error {
  margin-top: 0.75rem;
  padding: 0.56rem;
  background: rgba(255, 0, 0, 0.1);
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 6px;
  color: #ff6b6b;
  font-size: 0.675rem;
}

/* Mobile launcher pulsate */
@keyframes pulsate {
  0%,
  100% {
    transform: scale(1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }
  50% {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(255, 255, 255, 0.3);
  }
}
.audio-recorder__launcher--pulsate {
  animation: pulsate 0.6s ease-in-out;
}
/* Normalize launcher icon sizing - larger for bigger button */
.audio-recorder__launcher .launcher-icon {
  display: inline-grid;
  place-items: center;
  width: 20px;
  height: 20px;
}
.audio-recorder__launcher .launcher-icon svg {
  width: 100%;
  height: 100%;
}
/* Make all launcher icons slightly bigger */
.audio-recorder__launcher svg {
  width: 21px;
  height: 21px;
}

/* Cable Visual (simple CSS version) */
.detector-jack {
  position: absolute;
  bottom: 0.75rem;
  left: 0.75rem;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  /* Steel bezel base */
  background: radial-gradient(circle at 35% 35%, #7b7b7b, #3b3b3b 60%, #1a1a1a 100%);
  box-shadow:
    inset 0 2px 4px rgba(255, 255, 255, 0.18),
    inset 0 -2px 8px rgba(0, 0, 0, 0.55),
    0 2px 6px rgba(0, 0, 0, 0.35);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: opacity 0.2s ease;
}
/* Hide jack when mobile modal is open */
.audio-recorder__modal ~ * .detector-jack,
body:has(.audio-recorder__modal) .detector-jack {
  opacity: 0;
  pointer-events: none;
}
/* Hide mobile-only cable by default */
.mobile-cable {
  display: none;
}
/* Threaded bronze ring */
.detector-jack::before {
  content: '';
  position: absolute;
  inset: 4px;
  border-radius: 50%;
  background:
    /* Threads */
    repeating-conic-gradient(from 0deg, #cba362 0deg 8deg, #8c612c 8deg 16deg),
    /* Bronze sheen */ radial-gradient(circle at 35% 35%, #d2a76a, #986932 60%, #6c4920 100%);
  box-shadow:
    inset 0 2px 3px rgba(255, 255, 255, 0.2),
    inset 0 -2px 6px rgba(0, 0, 0, 0.45);
  filter: saturate(1.05) contrast(1.05);
}
/* Dark socket hole */
.detector-jack::after {
  content: '';
  position: absolute;
  inset: 9px;
  border-radius: 50%;
  background: radial-gradient(circle at 50% 45%, #0b0b0b, #111 55%, #000 100%);
  box-shadow:
    inset 0 1px 2px rgba(255, 255, 255, 0.1),
    inset 0 -2px 4px rgba(0, 0, 0, 0.7);
}
.input-container {
  position: relative;
}
.input-container__port {
  position: absolute;
  top: -9px;
  left: 50%;
  transform: translateX(-50%);
  width: 21px;
  height: 21px;
  border-radius: 50%;
  background: radial-gradient(circle at 35% 35%, #777, #3a3a3a 60%, #1f1f1f 100%);
  box-shadow:
    inset 0 2px 4px rgba(255, 255, 255, 0.18),
    inset 0 -2px 8px rgba(0, 0, 0, 0.55),
    0 2px 6px rgba(0, 0, 0, 0.35);
  border: 1px solid rgba(255, 255, 255, 0.2);
  pointer-events: none;
  z-index: 10; /* Ensure jack stays on top */
}
.input-container__port::before {
  content: '';
  position: absolute;
  inset: 4px;
  border-radius: 50%;
  background:
    repeating-conic-gradient(from 0deg, #cba362 0deg 8deg, #8c612c 8deg 16deg),
    radial-gradient(circle at 35% 35%, #d2a76a, #986932 60%, #6c4920 100%);
  box-shadow:
    inset 0 2px 3px rgba(255, 255, 255, 0.2),
    inset 0 -2px 6px rgba(0, 0, 0, 0.45);
}
.input-container__port::after {
  content: '';
  position: absolute;
  inset: 9px;
  border-radius: 50%;
  background: radial-gradient(circle at 50% 45%, #0b0b0b, #111 55%, #000 100%);
  box-shadow:
    inset 0 1px 2px rgba(255, 255, 255, 0.1),
    inset 0 -2px 4px rgba(0, 0, 0, 0.7);
}

/* SVG cable overlay */
.cable-overlay {
  display: block;
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 0;
}

/* Cable loading animation - data flow effect */

.cable-overlay--loading .cable-overlay__texture {
  animation: cable-pulse 1.5s ease-in-out infinite;
}

@keyframes cable-pulse {
  0%,
  100% {
    opacity: 0.9;
    stroke: #555;
  }
  50% {
    opacity: 1;
    stroke: #666;
  }
}

/* Animated data flow path */
.cable-overlay__data-flow {
  animation: data-flow 0.8s linear infinite;
}

@keyframes data-flow {
  0% {
    stroke-dashoffset: 0;
  }
  100% {
    stroke-dashoffset: -30;
  }
}

/* ============================================================================
   BREAKPOINTS DOCUMENTATION
   ============================================================================

   The mobile breakpoint controls when the app switches between:
     - Desktop: Side-by-side layout (meter + input panel)
     - Mobile: Stacked layout with modal-based input

   CURRENT VALUES:
     - Main breakpoint: 1440px
     - Small mobile: 768px (only affects FirstTimeOverlay text sizing)

   HOW TO CHANGE THE MAIN BREAKPOINT:

     You need to update 2 places:

     1. JavaScript constant (SINGLE SOURCE OF TRUTH):
        File: frontend/src/breakpoints.ts
        Update: MOBILE_BREAKPOINT = <new value>

     2. CSS media queries (cannot use JS variables):
        File: frontend/src/index.css (this file)
        Update BOTH:
          - @media (min-width: <new value>px)     [Desktop styles below]
          - @media (max-width: <new value - 1>px) [Mobile styles further below]

   WHY TWO PLACES?
     CSS media queries don't support CSS custom properties (--variables).
     This is a CSS specification limitation. The breakpoints.ts file serves as
     documentation and provides the JS values for useMediaQuery hooks.

   FILES THAT USE BREAKPOINTS:
     - frontend/src/breakpoints.ts                      - Constants & media query strings
     - frontend/src/index.css                           - CSS media queries (this file)
     - frontend/src/features/input/InputContainer.tsx   - Uses MEDIA_QUERIES.isMobile

   ============================================================================ */

/* ============================================
   RESPONSIVE STYLES - Desktop (min-width: 1440px)
   ============================================ */
@media (min-width: 1440px) {
  .audio-recorder {
    gap: 1.125rem;
  }

  .audio-recorder__waveform {
    padding: 1.125rem;
    min-height: 9rem;
  }

  .audio-recorder__waveform canvas {
    height: 7.5rem;
  }

  .audio-recorder__controls {
    gap: 0.94rem;
  }

  .audio-btn {
    padding: 0.675rem 1.31rem;
    font-size: 0.83rem;
  }

  .meter {
    width: min(
      100% - var(--meter-padding),
      max(600px, (100svh - var(--meter-padding)) * var(--meter-aspect-ratio))
    );
    padding-top: 0;
  }

  .input-container {
    padding: 1.875rem;
    padding-top: calc(1.125rem + 12px);
  }

  .stack {
    padding: 2.25rem;
    padding-top: calc(2.25rem + 15px);
  }

  .getting-started {
    gap: clamp(1.31rem, 2.25vw, 2.25rem);
  }

  .shared-textarea,
  .text-input__textarea {
    min-height: 105px;
    padding: 1.125rem;
    font-size: 0.86rem;
    line-height: 1.65;
  }

  .shared-textarea.audio-recorder__transcript {
    min-height: 52px;
    resize: none;
  }

  .first-time-overlay__text {
    font-size: 1.31rem;
  }
}

/* ============================================
   RESPONSIVE STYLES - Mobile (max-width: 1439px)
   ============================================ */
@media (max-width: 1439px) {
  main {
    grid-template-columns: 1fr;
    grid-template-rows: 1fr;
    place-items: center;
    padding: 0.75rem;
  }

  /* Hide the entire stack section on mobile, but keep it in DOM for the Portal */
  .stack {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
    grid-template-rows: 1fr 4fr;
  }

  .title-group {
    display: none; /* Hide the title on mobile - it will show on the meter instead */
  }

  .meter__title {
    display: block;
    text-align: center;
    font-family: 'Playfair Display', Georgia, serif;
    color: #d4af37;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    font-weight: 900;
    font-size: clamp(0.83rem, 3.75vw, 1.2rem);
    padding: 0.94rem 0.375rem 0.94rem;
    flex: 0 0 auto;
    text-shadow:
      0 2px 0 rgba(0, 0, 0, 0.6),
      0 -1px 0 rgba(255, 223, 150, 0.2),
      0 0 11px rgba(212, 175, 55, 0.25);
  }

  .meter {
    width: 100%;
    max-width: 450px;
    height: auto;
    padding-top: 0;
  }

  .meter__display {
    margin-block-start: 0; /* Remove top margin on mobile for vertical centering */
  }

  .audio-recorder__launcher {
    bottom: 0.75rem;
    right: 0.75rem;
    width: 3rem;
    height: 3rem;
  }

  .getting-started {
    gap: clamp(0.45rem, 1.35vw, 0.71rem);
  }

  .getting-started__title {
    font-size: clamp(0.975rem, 3.375vw, 1.31rem);
  }

  .getting-started__intro {
    font-size: clamp(0.86rem, 2.81vw, 1.05rem);
  }

  .getting-started__description,
  .getting-started__model,
  .getting-started__cta {
    font-size: clamp(0.79rem, 2.44vw, 0.975rem);
  }

  .input-container {
    padding: 0.75rem;
    border: none;
    background: transparent;
    min-height: auto;
    max-height: 100%;
    box-sizing: border-box;
    overflow: visible;
  }

  /* Hide desktop cable overlay on mobile */
  .cable-overlay {
    display: none;
  }

  /* Make jack visible on mobile (move it into viewport) */
  .input-container__port {
    top: 3px; /* Move into viewport instead of -9px */
  }

  /* Horizontal cable exiting jack and going off-screen */
  .mobile-cable {
    display: block;
    position: absolute;
    bottom: calc(0.75rem + 11px - 2px);
    right: calc(100% - (0.75rem + 11px));
    width: 120vw;
    height: 5px;
    background: linear-gradient(180deg, #2a2a2a, #444);
    border-radius: 3px;
    box-shadow:
      0 1px 2px rgba(0, 0, 0, 0.5),
      inset 0 1px 0 rgba(255, 255, 255, 0.08);
    z-index: 0;
    overflow: hidden;
  }

  /* Mobile cable loading animation - data flow effect */
  .mobile-cable--loading::after {
    content: '';
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      90deg,
      transparent 0px,
      transparent 8px,
      rgba(59, 130, 246, 0.6) 8px,
      rgba(59, 130, 246, 0.6) 15px,
      transparent 15px,
      transparent 22px
    );
    animation: mobile-cable-data-flow 0.6s linear infinite;
  }

  @keyframes mobile-cable-data-flow {
    0% {
      transform: translateX(-22px);
    }
    100% {
      transform: translateX(0);
    }
  }
}

/* ============================================
   First-time user overlay - All screen sizes
   ============================================ */
.first-time-overlay {
  position: fixed;
  inset: 0;
  background: transparent;
  z-index: 10000;
  pointer-events: none; /* Allow interaction with knob underneath */
  animation: fadeIn 0.4s ease-in;
  overflow: visible;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.first-time-overlay__content {
  position: absolute;
  left: 50%;
  top: 45%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 1.125rem;
  pointer-events: none;
}

.first-time-overlay__text {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: 1.125rem;
  font-weight: 700;
  text-align: center;
  color: #f7f3e3;
  /* Vintage brass plaque effect */
  background: linear-gradient(145deg, rgba(42, 37, 32, 0.95) 0%, rgba(26, 24, 22, 0.95) 100%);
  padding: 0.75rem 1.31rem;
  border-radius: 0.28rem;
  border: 2px solid rgba(212, 175, 55, 0.4);
  text-shadow:
    0 2px 0 rgba(0, 0, 0, 0.6),
    0 0 8px rgba(212, 175, 55, 0.15);
  line-height: 1.4;
  max-width: 262px;
  pointer-events: none; /* Don't block knob interaction */
  box-shadow:
    0 6px 19px rgba(0, 0, 0, 0.5),
    inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

/* Pulse the rotary knob for first-time users - brass glow */
.rotary__knob--pulse {
  animation: knobPulse 2.5s ease-in-out infinite;
}

@keyframes knobPulse {
  0%,
  100% {
    box-shadow:
      0 8px 25px rgba(0, 0, 0, 0.6),
      0 4px 10px rgba(0, 0, 0, 0.4),
      inset 0 2px 4px rgba(255, 255, 255, 0.08),
      inset 0 -3px 8px rgba(0, 0, 0, 0.4),
      0 0 0 2px rgba(139, 115, 85, 0.2),
      0 0 0 0 rgba(212, 175, 55, 0);
  }
  50% {
    box-shadow:
      0 8px 25px rgba(0, 0, 0, 0.6),
      0 4px 10px rgba(0, 0, 0, 0.4),
      inset 0 2px 4px rgba(255, 255, 255, 0.08),
      inset 0 -3px 8px rgba(0, 0, 0, 0.4),
      0 0 0 3px rgba(212, 175, 55, 0.5),
      0 0 30px 12px rgba(212, 175, 55, 0.25),
      0 0 50px 20px rgba(212, 175, 55, 0.1);
  }
}

/* Small mobile adjustments - see breakpoints.ts SMALL_MOBILE_BREAKPOINT */
@media (max-width: 768px) {
  .first-time-overlay__content {
    flex-direction: column;
    gap: 0.375rem;
  }

  .first-time-overlay__text {
    font-size: 0.94rem;
    padding: 0.47rem 0.94rem;
  }
}

/* ============================================================================
 * MODAL OVERRIDES - Keep at end of file for proper cascade
 * ============================================================================
 * These styles override base component styles for modal contexts.
 * They appear last to ensure they win in the cascade, even with equal specificity.
 * Using .audio-recorder__modal.audio-recorder__modal increases specificity to (0,2,0)
 * which beats single-class selectors (0,1,0) without needing !important.
 */

/* Shared textarea in modals - applies to both text input and audio recorder transcript */
.audio-recorder__modal.audio-recorder__modal .shared-textarea {
  min-height: 10.5rem;
  padding: 1.5rem;
  font-size: clamp(1.01rem, 2.625vw, 1.24rem);
  line-height: 1.7;
}

/* Text input send button in modals */
.audio-recorder__modal.audio-recorder__modal .text-input__send-btn {
  padding: 0.75rem 1.5rem;
  font-size: clamp(1.01rem, 2.625vw, 1.2rem);
  border-radius: 0.56rem;
}

/* Text input error messages in modals */
.audio-recorder__modal.audio-recorder__modal .text-input__error {
  font-size: clamp(0.94rem, 2.25vw, 1.125rem);
  padding: 0.75rem;
}

/* Text input controls container in modals */
.audio-recorder__modal.audio-recorder__modal .text-input__controls {
  margin-top: 1.125rem;
}

/* Getting Started content in modals - larger text for better readability */
.audio-recorder__modal.audio-recorder__modal .getting-started__title {
  font-size: clamp(1.31rem, 4.5vw, 1.8rem);
}

.audio-recorder__modal.audio-recorder__modal .getting-started__intro {
  font-size: clamp(1.125rem, 3vw, 1.425rem);
}

.audio-recorder__modal.audio-recorder__modal .getting-started__description,
.audio-recorder__modal.audio-recorder__modal .getting-started__model,
.audio-recorder__modal.audio-recorder__modal .getting-started__cta {
  font-size: clamp(1.01rem, 2.625vw, 1.275rem);
  line-height: 1.7;
}

/* ================================================
   Utilities Layer
   ================================================ */

@layer utilities {
  /* Visually hidden content for screen readers only
     Use this to provide context to screen reader users without affecting visual layout */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* Shared keyboard shortcut styling
     Used by: .audio-recorder__mic__shortcut, .audio-btn__shortcut, .text-input__send-btn__shortcut
     Component-specific variations are applied in their respective classes */
  .kbd-shortcut,
  .audio-recorder__mic__shortcut,
  .audio-btn__shortcut,
  .text-input__send-btn__shortcut {
    font-family:
      system-ui,
      -apple-system,
      sans-serif;
    font-weight: 600;
    box-shadow:
      0 1px 0 rgba(255, 255, 255, 0.1),
      inset 0 1px 2px rgba(0, 0, 0, 0.3);
    letter-spacing: 0.02em;
  }
}
